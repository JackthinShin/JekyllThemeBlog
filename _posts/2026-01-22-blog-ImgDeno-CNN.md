---
title: "基于卷积神经网络的图像降噪方法研究(Image Denoising Based on Convolutional Neural Networks)"
math: true
categories:
  - Blog
tags:
  - 深度学习
  - 神经网络
  - CNN
  - 图像降噪
---

## 1. Background

 > 为什么会想到做这样一个实验尝试？

这是我 2025年秋季学期通识课程的作业(课程为：人工神经网络与深度学习基础)

实话说，大一上的课程有一半左右都是水课（上课不听的那种），还有四分之一是公共课（得好好学，考试重要），剩下的仅有的两门：计算机科学与技术导论、人工神经网络与深度学习基础，在陌生的城市，带着一颗低落的心，这两门是仅有的能让我提起兴趣，给我带来快乐感的课。

……

摄影、计算机技术能摩擦出怎样的火花？我十分好奇，也十分有兴趣。

无聊的我开始了和ChatGPT的对话，我在和他构建由这两个方向共同撑起的世界，我发现当你认真自己思考事情，遇到了一些小的、和事情本身关联性不大的能力型(?)困难时，AI就是这样一个，高质量的工具。有些难以表达这种感受，比如在构建，思考摄影、技术结合的未来可能性这件事上，我自己完全可以一步一步花时间深挖、思考、记录、补充，但在用上AI后，这件事情的做法就出现了变化，brainstorm的过程变成了和一个能理解你的朋友交流的过程，他是一个能理解你，知道你意思的朋友（虽然很多时候是不能知道的，但可以归结于自己的表达能力不够），在和他沟通的时候，他又能帮你记录下这一切，你只需要口述，我还尝试让他一直提醒我，让我别忘了这一切蓝图前景，让我保持激情，同时为我的生活提供动力，但是很遗憾，他不能跳出对话框。

![和ChatGPT的聊天](/JekyllThemeBlog/assets/images/ImgDeno-CNN/ChatGPT.jpg)

回归正题，当通识课布置出一个**期末小论文**这样的作业的时候，我是有些没头绪的，甚至有些担心会不会就这样水过去了。还好，我找到了一个有趣的题材；幸好，我有足够的兴趣研究这件事情；更好，课上学的Matlab以及知识点确实能帮助我进一步了解我感兴趣的影像领域，这不是在应付作业，或者说，这个实验的根本目的甚至不是为了完成这样一个期末任务，而是一次我自己的探索。这是我想象中课程学习价值的最正确的兑现形式。

计导课也给了我很大的启发，课上提到了CV相关的内容，让我知道了很多基础的图像后期处理操作都是通过卷积的方式，比如锐化、模糊等等，对于这些底层的技术内容有了更深一步的了解，那节课提到这一点的那页PPT简直让我醍醐灌顶！！

拓宽CNN传统情况中的**数据**对**标签**形式
>是否能打破传统局限思考，让**数据**和**标签**形式一致？

带着这样的思考，我的脑中跳出了由高噪点图像到低噪点图像的对应。这一种独特的**映射关系**，不正是符合CNN吗？

当然，有了想法之后，是时候开始思考可行性：

- 高噪点和低噪点之间的关系是否能找到规律？
- 不同环境下的情况怎么办？
- 噪点产生的原因有多种，合理性？
- ……

从这些角度来看，这样一个实验似乎完完全全是不成熟的，但又何妨？Just do it.

抱着多多少少能得到一些收获的心态，我开始了实验。

## 2. Let's do it!

由于具体、正式的内容已经在[论文(自己玩玩的)](</JekyllThemeBlog/assets/essays/基于卷积神经网络的图像降噪方法研究.pdf>)中较为完整地给出，本文章只会做我想留下的补充，做记录和复盘用途。
~~翻译：想到啥说啥~~

### 整体思路流程

> 本文所提出的图像降噪方法流程主要包括数据采集与预处理、卷积神经网络模型构建、模型训练以及图像仿真预测四个阶段。首先，在暗光环境下固定拍摄场景，分别使用`高 ISO` 与`低 ISO` 参数获取成对图像数据。随后，对图像进行裁剪并划分为固定大小的图像`patch`，构建训练样本。接着，设计并训练卷积神经网络模型，使其学习高噪声图像到低噪声图像之间的`映射关系`。最后，将训练完成的模型应用于完整图像的降噪处理，实现仿真预测。

#### 首先是数据集的准备：

在答辩时，老师问我：这些高低噪点的图像都是你自己准备的吗？
我的第一反应是“不然呢？”
而思考之后，这句话也让我意识到了很多东西：

- 对于我一个玩摄影的来说，准备这些数据集完全不是问题，但并不是所有人都这样，应该说大部分人不会有对这方面垂直的了解，当然，也从另一方面说明了我的选题合理与贴合性：
  > 为了获取真实的图像噪声数据，本文在暗光环境下使用相机对同一场景进行多次拍摄，分别设置`高 ISO （ISO 12800）`和`低 ISO （ISO 100）`参数。`高 ISO 图像`由于感光度较高，包含较多噪声信息，而`低 ISO 图像`则相对清晰，噪声较少。为了保证除了噪点信息差异外，图像内容不存在偏差，在调整 ISO 时同时调整快门速度，确保画面曝光一致。
- 通过从老师的角度思考这句话，我了解到了在对于神经网络的应用里，**数据**的重要性，如ImageNet的存在同样说明了这一点，在AI时代，除了底层算法逻辑的改动之外，能比拼出差距的地方就在于：数据、算力——又联想到内存的断供、电力行业的蓬勃前景

高 ISO 与低 ISO 图像对比示例:
![1](/JekyllThemeBlog/assets/images/ImgDeno-CNN/Compare1.png)

#### 数据预处理与Patch切分

这一步骤是我自己没有构想出来的，源于ChatGPT为我设计的实验思路，学习了

图像 Patch 切分示意图:
![2](/JekyllThemeBlog/assets/images/ImgDeno-CNN/PatchDemo.png)

#### 卷积神经网络模型构建与训练

网络结构如下：
![3](/JekyllThemeBlog/assets/images/ImgDeno-CNN/net.png)

> 本文所采用的卷积神经网络由多层卷积层和非线性激活层组成。网络输入为大小为 `64 × 64 × 3` 的 RGB 图像 `patch`，输出为对应的降噪图像`patch`。网络整体由三层卷积层和非线性激活层构成，卷积核大小均为 `3 × 3`，并采用相同填充（same padding）方式以保持特征图尺寸不变。
> 在网络结构中，前两层卷积层的通道数设置为 `32`，并在每一层卷积后引入`ReLU`激活函数，以增强网络的非线性表达能力。最后一层卷积层将特征映射回`3`个通道，用于**重建** RGB 彩色图像。由于图像降噪任务属于回归问题，网络输出直接与低 ISO 图像进行比较，并采用回归损失函数进行优化。

训练情况：
![4](/JekyllThemeBlog/assets/images/ImgDeno-CNN/TraPro.png)

其实我在这一步十分确认这个实验的实际学术价值并不大了，哪有一轮不到就学习明白了的。

至少是没有学出真正规律的。

#### 图像仿真预测

这是最激动人心的环节了，摄影后期的降噪具体操作对摄影师来说是一个工具，我们并不知道具体的实现方式，这也是这一个实验的快乐之一，我似乎在打造一个自己的降噪工具，哈哈。

样例1

![01](/JekyllThemeBlog/assets/images/ImgDeno-CNN/Pre1.png)

样例2

![02](/JekyllThemeBlog/assets/images/ImgDeno-CNN/Pre2.png)

样例3

![03](/JekyllThemeBlog/assets/images/ImgDeno-CNN/Pre3.png)

样例4

![04](/JekyllThemeBlog/assets/images/ImgDeno-CNN/Pre4.png)

谁懂出结果时的激动
……

## 3. Thoughts~

大家都知道，把时间投入到真正感兴趣的事情中，会很快乐且有意义，将爱好变成职业更是无数人梦寐以求的未来。而我发现自己有时在这个道理面前自欺欺人，我似乎在把道理当作方法，亵渎它，利用它，这好像是一种传统的说教思维：反过来告诉自己这件事情就是你喜欢的，感兴趣的，那你就可以有动力了。

我们总是期待美好，却又在无数的现实面前妥协，接受洋装美好的侵入，并且说服自己快乐地接受、享受。

18岁的我不希望自己被局限，未来的可能性掌握在自己手中，若现在妥协，不就是把自己的理想与未来亲手抹碎。

**Let's go！Jackthin!**

**Just do it!**

论文：[基于卷积神经网络的图像降噪方法研究.pdf](</JekyllThemeBlog/assets/essays/基于卷积神经网络的图像降噪方法研究.pdf>)
